import{_ as H}from"./DlAUqK2U.js";import{x as M,y as m,z as U,A as z,B as F,C as G,D as I,v as $,q,E as w,G as x,H as J,k as W,I as Q,J as X,K as Y,L as Z,o as K,c as p,a as g}from"./lWxxWymJ.js";const k={trailing:!0};function A(e,a=25,s={}){if(s={...k,...s},!Number.isFinite(a))throw new TypeError("Expected `wait` to be a finite number");let u,t,c=[],n,v;const _=(y,i)=>(n=ee(e,y,i),n.finally(()=>{if(n=null,s.trailing&&v&&!t){const h=_(y,v);return v=null,h}}),n);return function(...y){return n?(s.trailing&&(v=y),n):new Promise(i=>{const h=!t&&s.leading;clearTimeout(t),t=setTimeout(()=>{t=null;const o=s.leading?u:_(this,y);for(const D of c)D(o);c=[]},a),h?(u=_(this,y),i(u)):c.push(i)})}}async function ee(e,a,s){return await e.apply(a,s)}const ae=Symbol.for("nuxt:client-only"),te=e=>e==="defer"||e===!1;function E(...e){var D;const a=typeof e[e.length-1]=="string"?e.pop():void 0;ne(e[0],e[1])&&e.unshift(a);let[s,u,t={}]=e;const c=$(()=>Z(s));if(typeof c.value!="string")throw new TypeError("[nuxt] [useAsyncData] key must be a string.");if(typeof u!="function")throw new TypeError("[nuxt] [useAsyncData] handler must be a function.");const n=M();t.server??(t.server=!0),t.default??(t.default=re),t.getCachedData??(t.getCachedData=V),t.lazy??(t.lazy=!1),t.immediate??(t.immediate=!0),t.deep??(t.deep=m.deep),t.dedupe??(t.dedupe="cancel"),t._functionName,n._asyncData[c.value];const v={cause:"initial",dedupe:t.dedupe};(D=n._asyncData[c.value])!=null&&D._init||(v.cachedData=t.getCachedData(c.value,n,{cause:"initial"}),n._asyncData[c.value]=R(n,c.value,u,t,v.cachedData));const _=n._asyncData[c.value];_._deps++;const y=()=>n._asyncData[c.value].execute(v),i=t.server!==!1&&n.payload.serverRendered;{let r=function(d){const f=n._asyncData[d];f!=null&&f._deps&&(f._deps--,f._deps===0&&(f==null||f._off()))};const l=X();if(l&&i&&t.immediate&&!l.sp&&(l.sp=[]),l&&!l._nuxtOnBeforeMountCbs){l._nuxtOnBeforeMountCbs=[];const d=l._nuxtOnBeforeMountCbs;U(()=>{d.forEach(f=>{f()}),d.splice(0,d.length)}),z(()=>d.splice(0,d.length))}const P=l&&(l._nuxtClientOnly||F(ae,!1));i&&n.isHydrating&&(_.error.value||_.data.value!=null)?(_.pending.value=!1,_.status.value=_.error.value?"error":"success"):l&&(!P&&n.payload.serverRendered&&n.isHydrating||t.lazy)&&t.immediate?l._nuxtOnBeforeMountCbs.push(y):t.immediate&&y();const j=Y(),L=G([c,...t.watch||[]],([d],[f])=>{var O,S;if((d||f)&&d!==f){const T=((O=n._asyncData[f])==null?void 0:O.data.value)!==m.value;f&&r(f);const C={cause:"initial",dedupe:t.dedupe};(S=n._asyncData[d])!=null&&S._init||(C.cachedData=t.getCachedData(d,n,{cause:"initial"}),n._asyncData[d]=R(n,d,u,t,C.cachedData)),n._asyncData[d]._deps++,(t.immediate||T)&&n._asyncData[d].execute(C)}else _._execute({cause:"watch",dedupe:t.dedupe})},{flush:"sync"});j&&I(()=>{L(),r(c.value)})}const h={data:b(()=>{var r;return(r=n._asyncData[c.value])==null?void 0:r.data}),pending:b(()=>{var r;return(r=n._asyncData[c.value])==null?void 0:r.pending}),status:b(()=>{var r;return(r=n._asyncData[c.value])==null?void 0:r.status}),error:b(()=>{var r;return(r=n._asyncData[c.value])==null?void 0:r.error}),refresh:(...r)=>n._asyncData[c.value].execute(...r),execute:(...r)=>n._asyncData[c.value].execute(...r),clear:()=>N(n,c.value)},o=Promise.resolve(n._asyncDataPromises[c.value]).then(()=>h);return Object.assign(o,h),o}function b(e){return $({get(){var a;return(a=e())==null?void 0:a.value},set(a){const s=e();s&&(s.value=a)}})}function ne(e,a){return!(typeof e=="string"||typeof e=="object"&&e!==null||typeof e=="function"&&typeof a=="function")}function N(e,a){a in e.payload.data&&(e.payload.data[a]=void 0),a in e.payload._errors&&(e.payload._errors[a]=m.errorValue),e._asyncData[a]&&(e._asyncData[a].data.value=void 0,e._asyncData[a].error.value=m.errorValue,e._asyncData[a].pending.value=!1,e._asyncData[a].status.value="idle"),a in e._asyncDataPromises&&(e._asyncDataPromises[a]&&(e._asyncDataPromises[a].cancelled=!0),e._asyncDataPromises[a]=void 0)}function se(e,a){const s={};for(const u of a)s[u]=e[u];return s}function R(e,a,s,u,t){var h;(h=e.payload._errors)[a]??(h[a]=m.errorValue);const c=u.getCachedData!==V,n=s,v=u.deep?q:w,_=t!=null,y=e.hook("app:data:refresh",async o=>{(!o||o.includes(a))&&await i.execute({cause:"refresh:hook"})}),i={data:v(_?t:u.default()),pending:w(!_),error:Q(e.payload._errors,a),status:w("idle"),execute:(o={})=>{if(e._asyncDataPromises[a]){if(te(o.dedupe??u.dedupe))return e._asyncDataPromises[a];e._asyncDataPromises[a].cancelled=!0}if(o.cause==="initial"||e.isHydrating){const r="cachedData"in o?o.cachedData:u.getCachedData(a,e,{cause:o.cause??"refresh:manual"});if(r!=null)return e.payload.data[a]=i.data.value=r,i.error.value=m.errorValue,i.status.value="success",Promise.resolve(r)}i.pending.value=!0,i.status.value="pending";const D=new Promise((r,l)=>{try{r(n(e))}catch(P){l(P)}}).then(async r=>{if(D.cancelled)return e._asyncDataPromises[a];let l=r;u.transform&&(l=await u.transform(r)),u.pick&&(l=se(l,u.pick)),e.payload.data[a]=l,i.data.value=l,i.error.value=m.errorValue,i.status.value="success"}).catch(r=>{if(D.cancelled)return e._asyncDataPromises[a];i.error.value=J(r),i.data.value=W(u.default()),i.status.value="error"}).finally(()=>{D.cancelled||(i.pending.value=!1,delete e._asyncDataPromises[a])});return e._asyncDataPromises[a]=D,e._asyncDataPromises[a]},_execute:A((...o)=>i.execute(...o),0,{leading:!0}),_default:u.default,_deps:0,_init:!0,_hash:void 0,_off:()=>{var o;y(),(o=e._asyncData[a])!=null&&o._init&&(e._asyncData[a]._init=!1),c||x(()=>{var D;(D=e._asyncData[a])!=null&&D._init||(N(e,a),i.execute=()=>Promise.resolve(),i.data.value=m.value)})}};return i}const re=()=>m.value,V=(e,a,s)=>{if(a.isHydrating)return a.payload.data[e];if(s.cause!=="refresh:manual"&&s.cause!=="refresh:hook")return a.static.data[e]},ce={},ie={class:"flex flex-col items-center justify-center py-16 gap-4"};function ue(e,a){return K(),p("div",ie,[...a[0]||(a[0]=[g("div",{class:"relative w-10 h-10"},[g("div",{class:"absolute inset-0 rounded-full border-2 border-ink/5 dark:border-white/5"}),g("div",{class:"absolute inset-0 rounded-full border-2 border-transparent border-t-brand animate-spin-slow"})],-1),g("span",{class:"text-xs tracking-widest uppercase text-ink-muted dark:text-neutral-500"}," Loading ",-1)])])}const de=H(ce,[["render",ue]]),B="https://de1.api.radio-browser.info/json";function fe(){return E("countries",async()=>(await $fetch(`${B}/countries`)).filter(a=>a.stationcount>0).map(a=>({code:a.iso_3166_1,name:a.name,count:a.stationcount})).sort((a,s)=>a.name.localeCompare(s.name)))}function _e(e){const a=`stations-${(e==null?void 0:e.country)||""}-${(e==null?void 0:e.genre)||""}`;return E(a,async()=>{const s=new URL(`${B}/stations/search`);return e!=null&&e.country&&s.searchParams.set("countrycode",e.country),e!=null&&e.genre&&s.searchParams.set("tag",e.genre),s.searchParams.set("limit","50"),(await $fetch(s.toString())).filter(t=>t.url_resolved&&t.bitrate>0).map(t=>({id:t.stationuuid,name:t.name,streamUrl:t.url_resolved,favicon:t.favicon||null,country:t.country,countryCode:t.countrycode,tags:t.tags?t.tags.split(","):[],bitrate:t.bitrate,codec:t.codec,popularity:t.clickcount,isPlayable:!0})).sort((t,c)=>c.popularity-t.popularity)},"$woKC1hD-ej")}function De(){return E("genres",async()=>(await $fetch(`${B}/tags`)).filter(a=>a.stationcount>20).map(a=>({slug:a.name,count:a.stationcount})).sort((a,s)=>s.count-a.count))}export{de as L,De as a,fe as b,_e as u};
