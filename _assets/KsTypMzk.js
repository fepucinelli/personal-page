import{_ as U}from"./DlAUqK2U.js";import{z as H,A as g,B as M,x as z,C as F,v as G,D as I,s as R,q,E as S,G as x,H as J,k as W,I as Q,J as X,K as Y,L as Z,o as K,c as k,a as m}from"./D5QM857S.js";const p={trailing:!0};function A(e,a=25,s={}){if(s={...p,...s},!Number.isFinite(a))throw new TypeError("Expected `wait` to be a finite number");let r,t,i=[],n,y;const _=(v,u)=>(n=ee(e,v,u),n.finally(()=>{if(n=null,s.trailing&&y&&!t){const D=_(v,y);return y=null,D}}),n);return function(...v){return n?(s.trailing&&(y=v),n):new Promise(u=>{const D=!t&&s.leading;clearTimeout(t),t=setTimeout(()=>{t=null;const l=s.leading?r:_(this,v);for(const h of i)h(l);i=[]},a),D?(r=_(this,v),u(r)):i.push(u)})}}async function ee(e,a,s){return await e.apply(a,s)}const ae=Symbol.for("nuxt:client-only"),te=e=>e==="defer"||e===!1;function E(...e){var h;const a=typeof e[e.length-1]=="string"?e.pop():void 0;ne(e[0],e[1])&&e.unshift(a);let[s,r,t={}]=e;const i=R(()=>Z(s));if(typeof i.value!="string")throw new TypeError("[nuxt] [useAsyncData] key must be a string.");if(typeof r!="function")throw new TypeError("[nuxt] [useAsyncData] handler must be a function.");const n=H();t.server??(t.server=!0),t.default??(t.default=se),t.getCachedData??(t.getCachedData=N),t.lazy??(t.lazy=!1),t.immediate??(t.immediate=!0),t.deep??(t.deep=g.deep),t.dedupe??(t.dedupe="cancel"),t._functionName,n._asyncData[i.value];const y={cause:"initial",dedupe:t.dedupe};(h=n._asyncData[i.value])!=null&&h._init||(y.cachedData=t.getCachedData(i.value,n,{cause:"initial"}),n._asyncData[i.value]=O(n,i.value,r,t,y.cachedData));const _=n._asyncData[i.value];_._deps++;const v=()=>n._asyncData[i.value].execute(y),u=t.server!==!1&&n.payload.serverRendered;{let c=function(d){const f=n._asyncData[d];f!=null&&f._deps&&(f._deps--,f._deps===0&&(f==null||f._off()))};const o=X();if(o&&u&&t.immediate&&!o.sp&&(o.sp=[]),o&&!o._nuxtOnBeforeMountCbs){o._nuxtOnBeforeMountCbs=[];const d=o._nuxtOnBeforeMountCbs;M(()=>{d.forEach(f=>{f()}),d.splice(0,d.length)}),z(()=>d.splice(0,d.length))}const C=o&&(o._nuxtClientOnly||F(ae,!1));u&&n.isHydrating&&(_.error.value||_.data.value!=null)?(_.pending.value=!1,_.status.value=_.error.value?"error":"success"):o&&(!C&&n.payload.serverRendered&&n.isHydrating||t.lazy)&&t.immediate?o._nuxtOnBeforeMountCbs.push(v):t.immediate&&v();const V=Y(),j=G([i,...t.watch||[]],([d],[f])=>{var $,B;if((d||f)&&d!==f){const T=(($=n._asyncData[f])==null?void 0:$.data.value)!==g.value;f&&c(f);const w={cause:"initial",dedupe:t.dedupe};(B=n._asyncData[d])!=null&&B._init||(w.cachedData=t.getCachedData(d,n,{cause:"initial"}),n._asyncData[d]=O(n,d,r,t,w.cachedData)),n._asyncData[d]._deps++,(t.immediate||T)&&n._asyncData[d].execute(w)}else _._execute({cause:"watch",dedupe:t.dedupe})},{flush:"sync"});V&&I(()=>{j(),c(i.value)})}const D={data:b(()=>{var c;return(c=n._asyncData[i.value])==null?void 0:c.data}),pending:b(()=>{var c;return(c=n._asyncData[i.value])==null?void 0:c.pending}),status:b(()=>{var c;return(c=n._asyncData[i.value])==null?void 0:c.status}),error:b(()=>{var c;return(c=n._asyncData[i.value])==null?void 0:c.error}),refresh:(...c)=>n._asyncData[i.value].execute(...c),execute:(...c)=>n._asyncData[i.value].execute(...c),clear:()=>L(n,i.value)},l=Promise.resolve(n._asyncDataPromises[i.value]).then(()=>D);return Object.assign(l,D),l}function b(e){return R({get(){var a;return(a=e())==null?void 0:a.value},set(a){const s=e();s&&(s.value=a)}})}function ne(e,a){return!(typeof e=="string"||typeof e=="object"&&e!==null||typeof e=="function"&&typeof a=="function")}function L(e,a){a in e.payload.data&&(e.payload.data[a]=void 0),a in e.payload._errors&&(e.payload._errors[a]=g.errorValue),e._asyncData[a]&&(e._asyncData[a].data.value=void 0,e._asyncData[a].error.value=g.errorValue,e._asyncData[a].pending.value=!1,e._asyncData[a].status.value="idle"),a in e._asyncDataPromises&&(e._asyncDataPromises[a]&&(e._asyncDataPromises[a].cancelled=!0),e._asyncDataPromises[a]=void 0)}function re(e,a){const s={};for(const r of a)s[r]=e[r];return s}function O(e,a,s,r,t){var D;(D=e.payload._errors)[a]??(D[a]=g.errorValue);const i=r.getCachedData!==N,n=s,y=r.deep?q:S,_=t!=null,v=e.hook("app:data:refresh",async l=>{(!l||l.includes(a))&&await u.execute({cause:"refresh:hook"})}),u={data:y(_?t:r.default()),pending:S(!_),error:Q(e.payload._errors,a),status:S("idle"),execute:(l={})=>{if(e._asyncDataPromises[a]){if(te(l.dedupe??r.dedupe))return e._asyncDataPromises[a];e._asyncDataPromises[a].cancelled=!0}if(l.cause==="initial"||e.isHydrating){const c="cachedData"in l?l.cachedData:r.getCachedData(a,e,{cause:l.cause??"refresh:manual"});if(c!=null)return e.payload.data[a]=u.data.value=c,u.error.value=g.errorValue,u.status.value="success",Promise.resolve(c)}u.pending.value=!0,u.status.value="pending";const h=new Promise((c,o)=>{try{c(n(e))}catch(C){o(C)}}).then(async c=>{if(h.cancelled)return e._asyncDataPromises[a];let o=c;r.transform&&(o=await r.transform(c)),r.pick&&(o=re(o,r.pick)),e.payload.data[a]=o,u.data.value=o,u.error.value=g.errorValue,u.status.value="success"}).catch(c=>{if(h.cancelled)return e._asyncDataPromises[a];u.error.value=J(c),u.data.value=W(r.default()),u.status.value="error"}).finally(()=>{h.cancelled||(u.pending.value=!1,delete e._asyncDataPromises[a])});return e._asyncDataPromises[a]=h,e._asyncDataPromises[a]},_execute:A((...l)=>u.execute(...l),0,{leading:!0}),_default:r.default,_deps:0,_init:!0,_hash:void 0,_off:()=>{var l;v(),(l=e._asyncData[a])!=null&&l._init&&(e._asyncData[a]._init=!1),i||x(()=>{var h;(h=e._asyncData[a])!=null&&h._init||(L(e,a),u.execute=()=>Promise.resolve(),u.data.value=g.value)})}};return u}const se=()=>g.value,N=(e,a,s)=>{if(a.isHydrating)return a.payload.data[e];if(s.cause!=="refresh:manual"&&s.cause!=="refresh:hook")return a.static.data[e]},ce={},ie={class:"flex flex-col items-center justify-center py-16 gap-4"};function ue(e,a){return K(),k("div",ie,[...a[0]||(a[0]=[m("div",{class:"relative w-10 h-10"},[m("div",{class:"absolute inset-0 rounded-full border-2 border-ink/5 dark:border-white/5"}),m("div",{class:"absolute inset-0 rounded-full border-2 border-transparent border-t-brand animate-spin-slow"})],-1),m("span",{class:"text-xs tracking-widest uppercase text-ink-muted dark:text-neutral-500"}," Loading ",-1)])])}const de=U(ce,[["render",ue]]),P="https://de1.api.radio-browser.info/json";function fe(){return E("countries",async()=>(await $fetch(`${P}/countries`)).filter(a=>a.stationcount>0).map(a=>({code:a.iso_3166_1,name:a.name,count:a.stationcount})).sort((a,s)=>a.name.localeCompare(s.name)))}function _e(e){const a=(e==null?void 0:e.limit)??50,s=(e==null?void 0:e.offset)??0,r=`stations-${(e==null?void 0:e.country)||""}-${(e==null?void 0:e.genre)||""}-${s}-${a}`;return E(r,async()=>{const t=new URL(`${P}/stations/search`);return e!=null&&e.country&&t.searchParams.set("countrycode",e.country),e!=null&&e.genre&&t.searchParams.set("tag",e.genre),t.searchParams.set("limit",String(a)),t.searchParams.set("offset",String(s)),(await $fetch(t.toString())).filter(n=>n.url_resolved&&n.bitrate>0).map(n=>({id:n.stationuuid,name:n.name,streamUrl:n.url_resolved,favicon:n.favicon||null,country:n.country,countryCode:n.countrycode,tags:n.tags?n.tags.split(","):[],bitrate:n.bitrate,codec:n.codec,popularity:n.clickcount,isPlayable:!0})).sort((n,y)=>y.popularity-n.popularity)},"$woKC1hD-ej")}async function ye(e){const a=new URL(`${P}/stations/search`);return e.country&&a.searchParams.set("countrycode",e.country),e.genre&&a.searchParams.set("tag",e.genre),a.searchParams.set("limit",String(e.limit)),a.searchParams.set("offset",String(e.offset)),(await $fetch(a.toString())).filter(r=>r.url_resolved&&r.bitrate>0).map(r=>({id:r.stationuuid,name:r.name,streamUrl:r.url_resolved,favicon:r.favicon||null,country:r.country,countryCode:r.countrycode,tags:r.tags?r.tags.split(","):[],bitrate:r.bitrate,codec:r.codec,popularity:r.clickcount,isPlayable:!0})).sort((r,t)=>t.popularity-r.popularity)}function he(){return E("genres",async()=>(await $fetch(`${P}/tags`)).filter(a=>a.stationcount>20).map(a=>({slug:a.name,count:a.stationcount})).sort((a,s)=>s.count-a.count))}export{de as L,he as a,fe as b,ye as f,_e as u};
