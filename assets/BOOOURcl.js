import{_ as L}from"./DlAUqK2U.js";import{z as M,A as m,B as H,C as U,D as N,x as z,E as C,G as F,H as G,q as I,I as q,J,K as W,L as Q,M as X,i as Y,N as Z,o as x,c as K,a as p}from"./DkhOQ1_5.js";const A={trailing:!0};function k(e,a=25,r={}){if(r={...A,...r},!Number.isFinite(a))throw new TypeError("Expected `wait` to be a finite number");let u,t,c=[],n,h;const _=(y,i)=>(n=ee(e,y,i),n.finally(()=>{if(n=null,r.trailing&&h&&!t){const v=_(y,h);return h=null,v}}),n);return function(...y){return n?(r.trailing&&(h=y),n):new Promise(i=>{const v=!t&&r.leading;clearTimeout(t),t=setTimeout(()=>{t=null;const o=r.leading?u:_(this,y);for(const D of c)D(o);c=[]},a),v?(u=_(this,y),i(u)):c.push(i)})}}async function ee(e,a,r){return await e.apply(a,r)}const ae=Symbol.for("nuxt:client-only"),te=e=>e==="defer"||e===!1;function w(...e){var D;const a=typeof e[e.length-1]=="string"?e.pop():void 0;ne(e[0],e[1])&&e.unshift(a);let[r,u,t={}]=e;const c=N(()=>W(r));if(typeof c.value!="string")throw new TypeError("[nuxt] [useAsyncData] key must be a string.");if(typeof u!="function")throw new TypeError("[nuxt] [useAsyncData] handler must be a function.");const n=M();t.server??(t.server=!0),t.default??(t.default=se),t.getCachedData??(t.getCachedData=$),t.lazy??(t.lazy=!1),t.immediate??(t.immediate=!0),t.deep??(t.deep=m.deep),t.dedupe??(t.dedupe="cancel"),t._functionName,n._asyncData[c.value];const h={cause:"initial",dedupe:t.dedupe};(D=n._asyncData[c.value])!=null&&D._init||(h.cachedData=t.getCachedData(c.value,n,{cause:"initial"}),n._asyncData[c.value]=S(n,c.value,u,t,h.cachedData));const _=n._asyncData[c.value];_._deps++;const y=()=>n._asyncData[c.value].execute(h),i=t.server!==!1&&n.payload.serverRendered;{let s=function(d){const f=n._asyncData[d];f!=null&&f._deps&&(f._deps--,f._deps===0&&(f==null||f._off()))};const l=Z();if(l&&i&&t.immediate&&!l.sp&&(l.sp=[]),l&&!l._nuxtOnBeforeMountCbs){l._nuxtOnBeforeMountCbs=[];const d=l._nuxtOnBeforeMountCbs;Q(()=>{d.forEach(f=>{f()}),d.splice(0,d.length)}),X(()=>d.splice(0,d.length))}const b=l&&(l._nuxtClientOnly||Y(ae,!1));i&&n.isHydrating&&(_.error.value||_.data.value!=null)?(_.pending.value=!1,_.status.value=_.error.value?"error":"success"):l&&(!b&&n.payload.serverRendered&&n.isHydrating||t.lazy)&&t.immediate?l._nuxtOnBeforeMountCbs.push(y):t.immediate&&y();const V=J(),j=H([c,...t.watch||[]],([d],[f])=>{var B,O;if((d||f)&&d!==f){const T=((B=n._asyncData[f])==null?void 0:B.data.value)!==m.value;f&&s(f);const P={cause:"initial",dedupe:t.dedupe};(O=n._asyncData[d])!=null&&O._init||(P.cachedData=t.getCachedData(d,n,{cause:"initial"}),n._asyncData[d]=S(n,d,u,t,P.cachedData)),n._asyncData[d]._deps++,(t.immediate||T)&&n._asyncData[d].execute(P)}else _._execute({cause:"watch",dedupe:t.dedupe})},{flush:"sync"});V&&U(()=>{j(),s(c.value)})}const v={data:g(()=>{var s;return(s=n._asyncData[c.value])==null?void 0:s.data}),pending:g(()=>{var s;return(s=n._asyncData[c.value])==null?void 0:s.pending}),status:g(()=>{var s;return(s=n._asyncData[c.value])==null?void 0:s.status}),error:g(()=>{var s;return(s=n._asyncData[c.value])==null?void 0:s.error}),refresh:(...s)=>n._asyncData[c.value].execute(...s),execute:(...s)=>n._asyncData[c.value].execute(...s),clear:()=>R(n,c.value)},o=Promise.resolve(n._asyncDataPromises[c.value]).then(()=>v);return Object.assign(o,v),o}function g(e){return N({get(){var a;return(a=e())==null?void 0:a.value},set(a){const r=e();r&&(r.value=a)}})}function ne(e,a){return!(typeof e=="string"||typeof e=="object"&&e!==null||typeof e=="function"&&typeof a=="function")}function R(e,a){a in e.payload.data&&(e.payload.data[a]=void 0),a in e.payload._errors&&(e.payload._errors[a]=m.errorValue),e._asyncData[a]&&(e._asyncData[a].data.value=void 0,e._asyncData[a].error.value=m.errorValue,e._asyncData[a].pending.value=!1,e._asyncData[a].status.value="idle"),a in e._asyncDataPromises&&(e._asyncDataPromises[a]&&(e._asyncDataPromises[a].cancelled=!0),e._asyncDataPromises[a]=void 0)}function re(e,a){const r={};for(const u of a)r[u]=e[u];return r}function S(e,a,r,u,t){var v;(v=e.payload._errors)[a]??(v[a]=m.errorValue);const c=u.getCachedData!==$,n=r,h=u.deep?z:C,_=t!=null,y=e.hook("app:data:refresh",async o=>{(!o||o.includes(a))&&await i.execute({cause:"refresh:hook"})}),i={data:h(_?t:u.default()),pending:C(!_),error:q(e.payload._errors,a),status:C("idle"),execute:(o={})=>{if(e._asyncDataPromises[a]){if(te(o.dedupe??u.dedupe))return e._asyncDataPromises[a];e._asyncDataPromises[a].cancelled=!0}if(o.cause==="initial"||e.isHydrating){const s="cachedData"in o?o.cachedData:u.getCachedData(a,e,{cause:o.cause??"refresh:manual"});if(s!=null)return e.payload.data[a]=i.data.value=s,i.error.value=m.errorValue,i.status.value="success",Promise.resolve(s)}i.pending.value=!0,i.status.value="pending";const D=new Promise((s,l)=>{try{s(n(e))}catch(b){l(b)}}).then(async s=>{if(D.cancelled)return e._asyncDataPromises[a];let l=s;u.transform&&(l=await u.transform(s)),u.pick&&(l=re(l,u.pick)),e.payload.data[a]=l,i.data.value=l,i.error.value=m.errorValue,i.status.value="success"}).catch(s=>{if(D.cancelled)return e._asyncDataPromises[a];i.error.value=G(s),i.data.value=I(u.default()),i.status.value="error"}).finally(()=>{D.cancelled||(i.pending.value=!1,delete e._asyncDataPromises[a])});return e._asyncDataPromises[a]=D,e._asyncDataPromises[a]},_execute:k((...o)=>i.execute(...o),0,{leading:!0}),_default:u.default,_deps:0,_init:!0,_hash:void 0,_off:()=>{var o;y(),(o=e._asyncData[a])!=null&&o._init&&(e._asyncData[a]._init=!1),c||F(()=>{var D;(D=e._asyncData[a])!=null&&D._init||(R(e,a),i.execute=()=>Promise.resolve(),i.data.value=m.value)})}};return i}const se=()=>m.value,$=(e,a,r)=>{if(a.isHydrating)return a.payload.data[e];if(r.cause!=="refresh:manual"&&r.cause!=="refresh:hook")return a.static.data[e]},ce={},ie={class:"flex items-center justify-center py-10"};function ue(e,a){return x(),K("div",ie,[...a[0]||(a[0]=[p("div",{class:"h-10 w-10 rounded-full border-4 border-gray-300 dark:border-gray-700 border-t-brand animate-spin"},null,-1)])])}const de=L(ce,[["render",ue]]),E="https://de1.api.radio-browser.info/json";function fe(){return w("countries",async()=>(await $fetch(`${E}/countries`)).filter(a=>a.stationcount>0).map(a=>({code:a.iso_3166_1,name:a.name,count:a.stationcount})).sort((a,r)=>a.name.localeCompare(r.name)))}function _e(e){const a=`stations-${(e==null?void 0:e.country)||""}-${(e==null?void 0:e.genre)||""}`;return w(a,async()=>{const r=new URL(`${E}/stations/search`);return e!=null&&e.country&&r.searchParams.set("countrycode",e.country),e!=null&&e.genre&&r.searchParams.set("tag",e.genre),r.searchParams.set("limit","50"),(await $fetch(r.toString())).filter(t=>t.url_resolved&&t.bitrate>0).map(t=>({id:t.stationuuid,name:t.name,streamUrl:t.url_resolved,favicon:t.favicon||null,country:t.country,countryCode:t.countrycode,tags:t.tags?t.tags.split(","):[],bitrate:t.bitrate,codec:t.codec,popularity:t.clickcount,isPlayable:!0})).sort((t,c)=>c.popularity-t.popularity)},"$woKC1hD-ej")}function De(){return w("genres",async()=>(await $fetch(`${E}/tags`)).filter(a=>a.stationcount>20).map(a=>({slug:a.name,count:a.stationcount})).sort((a,r)=>r.count-a.count))}export{de as L,De as a,fe as b,_e as u};
